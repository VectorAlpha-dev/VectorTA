---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'ema';
const indicatorName = 'Exponential Moving Average (EMA)';
const description = `The Exponential Moving Average (EMA) is a weighted moving average that gives more importance to recent prices, making it more responsive to new information than the Simple Moving Average. This enhanced responsiveness makes the EMA a favorite among traders for identifying trends early while maintaining enough smoothing to filter out market noise.`;
const parameters = [
  {
    "name": "period",
    "type": "number",
    "default": 20,
    "min": 2,
    "max": 200,
    "description": "Number of periods for the EMA calculation"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2>Overview</h2>
  <p>
    The Exponential Moving Average (EMA) represents one of the most fundamental yet powerful tools in technical analysis. 
    Unlike the Simple Moving Average that treats all data points equally, the EMA applies exponentially decreasing 
    weights to older data, making it more responsive to recent price changes. This characteristic makes the EMA 
    particularly valuable for traders who need to balance the competing demands of trend identification and noise 
    reduction in fast-moving markets.
  </p>
  <p>
    The genius of the EMA lies in its mathematical elegance: it maintains an infinite memory of all past prices while 
    giving practical importance only to recent data. This is achieved through a recursive calculation that incorporates 
    the previous EMA value, creating a smooth line that adapts quickly to price changes yet remains stable enough to 
    identify genuine trends. The EMA forms the foundation for many advanced indicators, including MACD, and is widely 
    used in trading systems across all timeframes and markets.
  </p>

  <h2>How It Works</h2>
  <p>The EMA calculation uses a smoothing factor to weight recent prices:</p>
  <ol>
    <li><strong>Calculate Multiplier:</strong> 2 / (Period + 1)</li>
    <li><strong>Apply Weighting:</strong> Current price gets highest weight</li>
    <li><strong>Recursive Calculation:</strong> Each EMA incorporates all previous values</li>
    <li><strong>Exponential Decay:</strong> Older prices have exponentially less influence</li>
    <li><strong>Smooth Output:</strong> Creates responsive yet stable trend line</li>
  </ol>
  
  <div class="not-prose bg-gray-100 dark:bg-gray-800 p-4 rounded-lg my-4 border border-gray-200 dark:border-gray-700">
    <p class="font-mono text-sm mb-0 text-gray-800 dark:text-gray-200">
      Multiplier (α) = 2 / (Period + 1)<br/>
      <br/>
      EMA Calculation:<br/>
      EMA[today] = (Price[today] × α) + (EMA[yesterday] × (1 - α))<br/>
      <br/>
      Or expanded:<br/>
      EMA = α × Price + (1 - α) × Previous_EMA<br/>
      <br/>
      Initial EMA (various methods):<br/>
      1. First EMA = First Price<br/>
      2. First EMA = SMA of first N prices<br/>
      3. First EMA = Average of all available prices<br/>
      <br/>
      Common EMA Periods:<br/>
      - 9 EMA: Very short-term momentum<br/>
      - 20 EMA: Short-term trend<br/>
      - 50 EMA: Medium-term trend<br/>
      - 200 EMA: Long-term trend
    </p>
  </div>

  <h2>Key Features</h2>
  <ul>
    <li><strong>Weighted Response:</strong> More weight to recent prices</li>
    <li><strong>Reduced Lag:</strong> Responds faster than SMA to price changes</li>
    <li><strong>Smooth Output:</strong> Less prone to whipsaws than price alone</li>
    <li><strong>Trend Identification:</strong> Clear visual representation of trend direction</li>
  </ul>

  <h2>Interpretation & Trading Signals</h2>
  
  <h3>Basic EMA Signals</h3>
  <div class="not-prose bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg my-4 border border-blue-200 dark:border-blue-800">
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Trend Direction:</h4>
    <ul class="list-disc list-inside mb-4 text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Rising EMA:</strong> Uptrend in progress</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Falling EMA:</strong> Downtrend in progress</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Flat EMA:</strong> Consolidation or ranging market</li>
      <li><strong class="text-gray-900 dark:text-gray-100">EMA Slope Change:</strong> Potential trend reversal</li>
    </ul>
    
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Price Relationship:</h4>
    <ul class="list-disc list-inside text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Price Above EMA:</strong> Bullish bias, potential support</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Price Below EMA:</strong> Bearish bias, potential resistance</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Price Crosses EMA:</strong> Momentum shift signal</li>
      <li><strong class="text-gray-900 dark:text-gray-100">EMA as Dynamic S/R:</strong> Acts as moving support/resistance</li>
    </ul>
  </div>

  <h3>Trading Strategies</h3>
  <ul>
    <li><strong>Single EMA Strategy:</strong>
      <ul>
        <li>Buy when price crosses above rising EMA</li>
        <li>Sell when price crosses below falling EMA</li>
        <li>Use EMA as trailing stop in trends</li>
        <li>Re-enter on successful retest of EMA</li>
      </ul>
    </li>
    <li><strong>EMA Crossover System:</strong>
      <ul>
        <li>Use fast EMA (9-12) and slow EMA (20-26)</li>
        <li>Buy when fast crosses above slow (Golden Cross)</li>
        <li>Sell when fast crosses below slow (Death Cross)</li>
        <li>Confirm with price above/below both EMAs</li>
      </ul>
    </li>
    <li><strong>Multiple EMA Ribbon:</strong>
      <ul>
        <li>Use 5-8 EMAs with incremental periods</li>
        <li>Strong trend when EMAs are parallel and separated</li>
        <li>Weakening trend when EMAs converge</li>
        <li>Trade pullbacks to the ribbon in strong trends</li>
      </ul>
    </li>
    <li><strong>EMA Bounce Strategy:</strong> Trade bounces off key EMAs (20, 50, 200)</li>
  </ul>

  <h3>Advanced Techniques</h3>
  <ul>
    <li><strong>Dynamic Period EMA:</strong> Adjust period based on volatility</li>
    <li><strong>Volume-Weighted EMA:</strong> Weight by volume for better signals</li>
    <li><strong>Multi-Timeframe EMA:</strong> Align EMAs across timeframes</li>
    <li><strong>EMA Bands:</strong> Add percentage or ATR bands around EMA</li>
  </ul>

  <h2>Practical Application</h2>
  
  <h3>Strengths</h3>
  <ul>
    <li>More responsive than SMA to recent changes</li>
    <li>Smooth enough to filter market noise</li>
    <li>Works well in trending markets</li>
    <li>Foundation for many other indicators</li>
    <li>Simple to calculate and understand</li>
  </ul>

  <h3>Limitations</h3>
  <ul>
    <li>Still lags behind price action</li>
    <li>Generates false signals in choppy markets</li>
    <li>Period selection affects performance significantly</li>
    <li>Less effective in ranging markets</li>
    <li>May miss very short-term opportunities</li>
  </ul>

  <h2>Combination with Other Indicators</h2>
  <p>The EMA works exceptionally well with:</p>
  <ul>
    <li><strong>MACD:</strong> Built from EMA calculations</li>
    <li><strong>RSI:</strong> EMA for trend, RSI for momentum</li>
    <li><strong>Bollinger Bands:</strong> Use EMA as the middle band</li>
    <li><strong>Volume:</strong> Confirm EMA signals with volume</li>
    <li><strong>Support/Resistance:</strong> Combine static and dynamic levels</li>
  </ul>

  <h2>Example Usage</h2>
  <p>Code examples will be available once the Rust implementation is complete.</p>

  <h2>Mathematical Background</h2>
  <p>
    The mathematical foundation of the EMA rests on the concept of exponential smoothing, first formalized by Robert 
    Brown and Charles Holt in the 1950s. The key insight is that an exponential moving average can be computed 
    recursively, requiring only the previous EMA value and the current price. This makes it computationally efficient 
    while maintaining a theoretically infinite memory of past prices.
  </p>
  <p>
    The smoothing factor α (alpha) determines the rate of exponential decay. With α = 2/(N+1), approximately 86.5% of 
    the EMA's value comes from the most recent N periods, while the remaining 13.5% represents the cumulative effect 
    of all earlier data. This creates a beautiful balance: recent prices dominate the calculation, but historical 
    context is never completely forgotten, preventing the indicator from overreacting to temporary price spikes while 
    maintaining responsiveness to genuine market shifts.
  </p>
</IndicatorLayout>