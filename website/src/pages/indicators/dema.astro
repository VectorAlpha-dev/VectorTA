---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'dema';
const indicatorName = 'Double Exponential Moving Average (DEMA)';
const description = `The Double Exponential Moving Average (DEMA) is an advanced technical indicator developed by Patrick Mulloy that provides a smoother and more responsive moving average by applying exponential smoothing twice. This innovative approach significantly reduces lag while maintaining the smoothing benefits of traditional moving averages, making it ideal for trend identification and timing.`;
const parameters = [
  {
    "name": "period",
    "type": "number",
    "default": 20,
    "min": 5,
    "max": 200,
    "description": "Number of periods for the exponential moving average calculation"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2>Overview</h2>
  <p>
    The Double Exponential Moving Average (DEMA), introduced by Patrick Mulloy in 1994, represents a significant 
    advancement in moving average technology. By applying exponential smoothing twice and using a clever mathematical 
    formula to combine the results, DEMA achieves what seemed impossible: a moving average that is both smoother 
    than a simple EMA and more responsive to price changes, with approximately half the lag.
  </p>
  <p>
    The genius of DEMA lies not in simply applying EMA twice (which would increase lag), but in using a specific 
    formula that cancels out much of the lag inherent in moving averages. This makes DEMA particularly valuable 
    for traders who need to identify trend changes quickly while avoiding the whipsaws common with more responsive 
    indicators. It's especially effective in trending markets where early entry and exit signals are crucial.
  </p>

  <h2>How It Works</h2>
  <p>DEMA uses a sophisticated calculation that combines two EMAs:</p>
  <ol>
    <li><strong>Calculate First EMA:</strong> Standard exponential moving average of price</li>
    <li><strong>Calculate Second EMA:</strong> Exponential moving average of the first EMA</li>
    <li><strong>Apply DEMA Formula:</strong> Combine both EMAs to reduce lag</li>
    <li><strong>Result:</strong> Smooth, responsive moving average with minimal lag</li>
  </ol>
  
  <div class="not-prose bg-gray-100 dark:bg-gray-800 p-4 rounded-lg my-4 border border-gray-200 dark:border-gray-700">
    <p class="font-mono text-sm mb-0 text-gray-800 dark:text-gray-200">
      EMA1 = EMA(Price, Period)<br/>
      <br/>
      EMA2 = EMA(EMA1, Period)<br/>
      <br/>
      DEMA = 2 × EMA1 - EMA2<br/>
      <br/>
      Where:<br/>
      - EMA1 = First exponential moving average<br/>
      - EMA2 = EMA of EMA (double smoothing)<br/>
      - The formula extracts trend with reduced lag
    </p>
  </div>

  <h2>Key Features</h2>
  <ul>
    <li><strong>Reduced Lag:</strong> Approximately 50% less lag than traditional EMA</li>
    <li><strong>Enhanced Smoothing:</strong> Smoother than simple EMA despite faster response</li>
    <li><strong>Trend Sensitivity:</strong> Quickly adapts to trend changes</li>
    <li><strong>Noise Reduction:</strong> Filters out market noise effectively</li>
  </ul>

  <h2>Interpretation & Trading Signals</h2>
  
  <h3>DEMA Analysis</h3>
  <div class="not-prose bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg my-4 border border-blue-200 dark:border-blue-800">
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Trend Identification:</h4>
    <ul class="list-disc list-inside mb-4 text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Rising DEMA:</strong> Uptrend in progress</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Falling DEMA:</strong> Downtrend in progress</li>
      <li><strong class="text-gray-900 dark:text-gray-100">DEMA Slope Change:</strong> Early trend reversal warning</li>
      <li><strong class="text-gray-900 dark:text-gray-100">DEMA Acceleration:</strong> Trend strengthening</li>
    </ul>
    
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Trading Signals:</h4>
    <ul class="list-disc list-inside text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Price Crosses Above DEMA:</strong> Bullish signal</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Price Crosses Below DEMA:</strong> Bearish signal</li>
      <li><strong class="text-gray-900 dark:text-gray-100">DEMA as Support:</strong> Bounces off rising DEMA</li>
      <li><strong class="text-gray-900 dark:text-gray-100">DEMA as Resistance:</strong> Rejections at falling DEMA</li>
    </ul>
  </div>

  <h3>Trading Strategies</h3>
  <ul>
    <li><strong>Trend Following:</strong>
      <ul>
        <li>Enter long when price crosses above rising DEMA</li>
        <li>Enter short when price crosses below falling DEMA</li>
        <li>Use DEMA slope to confirm trend direction</li>
      </ul>
    </li>
    <li><strong>Dynamic Support/Resistance:</strong>
      <ul>
        <li>Buy pullbacks to DEMA in uptrends</li>
        <li>Sell rallies to DEMA in downtrends</li>
        <li>Set stops beyond DEMA line</li>
      </ul>
    </li>
    <li><strong>Multiple DEMA System:</strong>
      <ul>
        <li>Use fast DEMA (10-period) and slow DEMA (30-period)</li>
        <li>Buy when fast crosses above slow</li>
        <li>Sell when fast crosses below slow</li>
      </ul>
    </li>
    <li><strong>DEMA Bands:</strong> Add percentage or ATR bands for entry/exit zones</li>
  </ul>

  <h3>Advanced Techniques</h3>
  <ul>
    <li><strong>Triple Screen:</strong> Combine multiple timeframe DEMAs</li>
    <li><strong>Momentum Confirmation:</strong> Use DEMA slope as momentum gauge</li>
    <li><strong>Adaptive DEMA:</strong> Adjust period based on market volatility</li>
    <li><strong>Pattern Recognition:</strong> Identify chart patterns using DEMA as baseline</li>
  </ul>

  <h2>Practical Application</h2>
  
  <h3>Strengths</h3>
  <ul>
    <li>Significantly reduced lag compared to EMA</li>
    <li>Excellent trend-following capabilities</li>
    <li>Smooth enough to avoid whipsaws</li>
    <li>Works well across all timeframes</li>
    <li>Simple to understand and implement</li>
  </ul>

  <h3>Limitations</h3>
  <ul>
    <li>Can overshoot during volatile periods</li>
    <li>Still has some lag despite improvements</li>
    <li>May give false signals in ranging markets</li>
    <li>More sensitive to price spikes than EMA</li>
    <li>Requires trending markets for best results</li>
  </ul>

  <h2>Combination with Other Indicators</h2>
  <p>DEMA works excellently when combined with:</p>
  <ul>
    <li><strong>MACD:</strong> Replace EMA with DEMA for faster signals</li>
    <li><strong>RSI:</strong> DEMA for trend, RSI for overbought/oversold</li>
    <li><strong>Bollinger Bands:</strong> Use DEMA as centerline</li>
    <li><strong>ATR:</strong> Set dynamic stops using DEMA ± ATR</li>
    <li><strong>Volume:</strong> Confirm DEMA breakouts with volume</li>
  </ul>

  <h2>Example Usage</h2>
  <p>Code examples will be available once the Rust implementation is complete.</p>

  <h2>Mathematical Background</h2>
  <p>
    The mathematical brilliance of DEMA lies in its lag-reduction formula. When you apply EMA twice, you introduce 
    additional lag. However, Mulloy discovered that by taking twice the original EMA and subtracting the double-smoothed 
    EMA, much of this lag cancels out. This works because the double-smoothed EMA lags behind the single EMA by 
    approximately the same amount that the single EMA lags behind price.
  </p>
  <p>
    The formula DEMA = 2×EMA - EMA(EMA) effectively extrapolates the EMA forward in time, compensating for its 
    inherent lag. This mathematical trick creates a moving average that responds to price changes almost as quickly 
    as the price itself moves, while still maintaining the noise-reduction benefits of exponential smoothing. The 
    result is an indicator that offers the best of both worlds: responsiveness and smoothness.
  </p>

</IndicatorLayout>