---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'donchian';
const indicatorName = 'Donchian Channels';
const description = `Donchian Channels, created by Richard Donchian, are a trend-following indicator that plots the highest high and lowest low over a specified period. These channels form a powerful breakout trading system, famously used by the Turtle Traders, and provide clear support/resistance levels while adapting dynamically to market volatility.`;
const parameters = [
  {
    "name": "high_period",
    "type": "number",
    "default": 20,
    "min": 5,
    "max": 100,
    "description": "Lookback period for the upper channel (highest high)"
  },
  {
    "name": "low_period",
    "type": "number",
    "default": 20,
    "min": 5,
    "max": 100,
    "description": "Lookback period for the lower channel (lowest low)"
  },
  {
    "name": "middle_period",
    "type": "number",
    "default": 20,
    "min": 5,
    "max": 100,
    "description": "Period for calculating the middle line (optional)"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2>Overview</h2>
  <p>
    Donchian Channels, developed by Richard Donchian in the 1960s, represent one of the oldest and most effective 
    trend-following systems in technical analysis. Often called "Price Channels" or "Trading Bands," they gained 
    legendary status through the Turtle Trading experiment, where novice traders used Donchian breakouts to generate 
    massive profits. The indicator's brilliance lies in its objectivity—it simply identifies the highest and lowest 
    prices over a specific period, creating a channel that expands and contracts with market volatility.
  </p>
  <p>
    What makes Donchian Channels particularly powerful is their dual nature: they serve both as a breakout system 
    and as dynamic support/resistance levels. When price breaks above the upper channel, it signals strength and 
    potential trend continuation. When it breaks below the lower channel, weakness is indicated. The middle line, 
    often added as the average of the upper and lower channels, provides an additional reference point for trend 
    direction and acts as a dynamic equilibrium level.
  </p>

  <h2>How It Works</h2>
  <p>Donchian Channels track price extremes over time:</p>
  <ol>
    <li><strong>Upper Channel:</strong> Highest high over the lookback period</li>
    <li><strong>Lower Channel:</strong> Lowest low over the lookback period</li>
    <li><strong>Middle Line:</strong> Average of upper and lower channels (optional)</li>
    <li><strong>Channel Width:</strong> Indicates volatility (wide = high volatility)</li>
    <li><strong>Dynamic Adjustment:</strong> Channels adjust as new highs/lows are made</li>
  </ol>
  
  <div class="not-prose bg-gray-100 dark:bg-gray-800 p-4 rounded-lg my-4 border border-gray-200 dark:border-gray-700">
    <p class="font-mono text-sm mb-0 text-gray-800 dark:text-gray-200">
      Upper Channel = Highest High over N periods<br/>
      Lower Channel = Lowest Low over N periods<br/>
      Middle Line = (Upper Channel + Lower Channel) / 2<br/>
      <br/>
      Channel Width = Upper Channel - Lower Channel<br/>
      <br/>
      Breakout Signals:<br/>
      Long Entry: Close &gt; Upper Channel<br/>
      Short Entry: Close &lt; Lower Channel<br/>
      <br/>
      Classic Turtle Rules:<br/>
      Entry: 20-period breakout<br/>
      Exit: 10-period opposite breakout<br/>
      Stop: 2 × ATR from entry
    </p>
  </div>

  <h2>Key Features</h2>
  <ul>
    <li><strong>Objective System:</strong> No interpretation needed, clear rules</li>
    <li><strong>Volatility Adaptive:</strong> Channels widen/narrow with market conditions</li>
    <li><strong>Trend Following:</strong> Captures major moves effectively</li>
    <li><strong>Risk Definition:</strong> Clear stop levels using channel boundaries</li>
  </ul>

  <h2>Interpretation & Trading Signals</h2>
  
  <h3>Channel Analysis</h3>
  <div class="not-prose bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg my-4 border border-blue-200 dark:border-blue-800">
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Channel Behavior:</h4>
    <ul class="list-disc list-inside mb-4 text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Expanding Channels:</strong> Increasing volatility, trending market</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Contracting Channels:</strong> Decreasing volatility, consolidation</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Flat Channels:</strong> Sideways market, range-bound</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Sloping Channels:</strong> Clear trend direction</li>
    </ul>
    
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Trading Signals:</h4>
    <ul class="list-disc list-inside text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Upper Breakout:</strong> Buy signal, new uptrend</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Lower Breakout:</strong> Sell signal, new downtrend</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Middle Line Cross:</strong> Trend bias change</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Failed Breakout:</strong> Potential reversal signal</li>
    </ul>
  </div>

  <h3>Trading Strategies</h3>
  <ul>
    <li><strong>Classic Breakout System:</strong>
      <ul>
        <li>Buy on close above upper channel</li>
        <li>Sell on close below lower channel</li>
        <li>Exit longs on lower channel break</li>
        <li>Exit shorts on upper channel break</li>
      </ul>
    </li>
    <li><strong>Turtle Trading Method:</strong>
      <ul>
        <li>Enter on 20-period channel breakout</li>
        <li>Exit on 10-period opposite channel break</li>
        <li>Position size based on ATR</li>
        <li>Add to winning positions on further breakouts</li>
      </ul>
    </li>
    <li><strong>Mean Reversion:</strong>
      <ul>
        <li>Sell at upper channel in ranging markets</li>
        <li>Buy at lower channel in ranging markets</li>
        <li>Use middle line as target</li>
        <li>Tight stops outside channels</li>
      </ul>
    </li>
    <li><strong>Dual Timeframe:</strong> Use longer period for trend, shorter for entry</li>
  </ul>

  <h3>Advanced Techniques</h3>
  <ul>
    <li><strong>Asymmetric Channels:</strong> Different periods for upper/lower channels</li>
    <li><strong>Volatility Filters:</strong> Trade only when channel width exceeds threshold</li>
    <li><strong>Multiple Channels:</strong> Layer different periods for confluence</li>
    <li><strong>Donchian Squeeze:</strong> Trade breakouts from narrow channels</li>
  </ul>

  <h2>Practical Application</h2>
  
  <h3>Strengths</h3>
  <ul>
    <li>Simple and objective rules</li>
    <li>Captures major trends effectively</li>
    <li>Self-adjusting to market conditions</li>
    <li>Clear entry and exit signals</li>
    <li>Time-tested and proven profitable</li>
  </ul>

  <h3>Limitations</h3>
  <ul>
    <li>Many whipsaws in ranging markets</li>
    <li>Late entry on trends (after breakout)</li>
    <li>No predictive element</li>
    <li>Can give back profits on exits</li>
    <li>Requires strong risk management</li>
  </ul>

  <h2>Combination with Other Indicators</h2>
  <p>Donchian Channels work excellently with:</p>
  <ul>
    <li><strong>ATR:</strong> Position sizing and stop placement</li>
    <li><strong>ADX:</strong> Filter trades by trend strength</li>
    <li><strong>Moving Averages:</strong> Confirm trend direction</li>
    <li><strong>Volume:</strong> Validate breakouts with volume surge</li>
    <li><strong>RSI:</strong> Avoid overbought/oversold breakouts</li>
  </ul>

  <h2>Example Usage</h2>
  <p>Code examples will be available once the Rust implementation is complete.</p>

  <h2>Mathematical Background</h2>
  <p>
    The mathematical simplicity of Donchian Channels is their greatest strength. By using only the maximum and 
    minimum functions over a rolling window, they create an adaptive envelope around price that requires no complex 
    calculations or assumptions about distribution. This simplicity makes them robust across different markets and 
    time periods—the same rules that worked in the 1960s continue to work today.
  </p>
  <p>
    The channels effectively implement a form of adaptive support and resistance that responds to market volatility. 
    During trending periods, one channel remains flat while the other continues to adjust, creating an expanding 
    channel that allows trends to run. During consolidations, both channels converge, setting up the next breakout. 
    This behavior naturally implements the trading wisdom of "letting profits run and cutting losses short."
  </p>

</IndicatorLayout>