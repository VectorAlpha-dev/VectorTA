---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'cfo';
const indicatorName = 'Chande Forecast Oscillator (CFO)';
const description = `The Chande Forecast Oscillator (CFO) is a momentum indicator developed by Tushar Chande that measures the percentage difference between the closing price and a linear regression forecast. It identifies when prices have moved too far from their statistical trend line, helping traders spot overbought/oversold conditions and potential reversals.`;
const parameters = [
  {
    "name": "period",
    "type": "number",
    "default": 14,
    "min": 2,
    "max": 200,
    "description": "Lookback period for linear regression calculation"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2>Overview</h2>
  <p>
    The Chande Forecast Oscillator (CFO), developed by Tushar Chande, is a unique momentum indicator that compares 
    the current closing price to a statistically forecasted price based on linear regression. Unlike traditional 
    oscillators that compare prices to moving averages, the CFO uses linear regression to project where the price 
    "should" be, then measures how far the actual price deviates from this forecast.
  </p>
  <p>
    This approach makes the CFO particularly effective at identifying when prices have stretched too far from their 
    underlying trend. The oscillator expresses this deviation as a percentage, making it easy to compare across 
    different securities and timeframes. When prices move significantly above or below the regression forecast, 
    it often signals an unsustainable condition that may lead to a reversal.
  </p>

  <h2>How It Works</h2>
  <p>The CFO calculation involves three steps:</p>
  <ol>
    <li><strong>Calculate Linear Regression:</strong> Fit a line through the last n closing prices</li>
    <li><strong>Determine Forecast:</strong> Project the next price using the regression line</li>
    <li><strong>Measure Deviation:</strong> Calculate percentage difference from forecast</li>
  </ol>
  
  <div class="not-prose bg-gray-100 dark:bg-gray-800 p-4 rounded-lg my-4 border border-gray-200 dark:border-gray-700">
    <p class="font-mono text-sm mb-0 text-gray-800 dark:text-gray-200">
      Linear Regression: Y = a + bX<br/>
      Where: b = Σ((X - X̄)(Y - Ȳ)) / Σ(X - X̄)²<br/>
      a = Ȳ - bX̄<br/>
      <br/>
      Forecast = a + b × (Period + 1)<br/>
      <br/>
      CFO = ((Close - Forecast) / Close) × 100<br/>
      <br/>
      Where:<br/>
      X = time series (1, 2, ..., n)<br/>
      Y = closing prices<br/>
      n = period length
    </p>
  </div>

  <h2>Key Features</h2>
  <ul>
    <li><strong>Trend-Adjusted:</strong> Uses linear regression to account for underlying trend</li>
    <li><strong>Percentage-Based:</strong> Normalized output allows cross-market comparison</li>
    <li><strong>Mean-Reverting:</strong> Assumes prices revert to regression line</li>
    <li><strong>Statistical Foundation:</strong> Based on proven regression analysis</li>
  </ul>

  <h2>Interpretation & Trading Signals</h2>
  
  <h3>Signal Levels</h3>
  <div class="not-prose bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg my-4 border border-blue-200 dark:border-blue-800">
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">CFO Readings:</h4>
    <ul class="list-disc list-inside mb-4 text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Above +3%:</strong> Significantly overbought</li>
      <li><strong class="text-gray-900 dark:text-gray-100">+1% to +3%:</strong> Mildly overbought</li>
      <li><strong class="text-gray-900 dark:text-gray-100">-1% to +1%:</strong> Neutral zone</li>
      <li><strong class="text-gray-900 dark:text-gray-100">-3% to -1%:</strong> Mildly oversold</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Below -3%:</strong> Significantly oversold</li>
    </ul>
    
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Trading Signals:</h4>
    <ul class="list-disc list-inside text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Extreme Reversals:</strong> Buy below -3%, sell above +3%</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Zero Line Cross:</strong> Bullish above 0, bearish below 0</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Divergences:</strong> Price/CFO divergences signal potential reversals</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Trend Confirmation:</strong> CFO direction confirms price trend</li>
    </ul>
  </div>

  <h3>Trading Strategies</h3>
  <ul>
    <li><strong>Mean Reversion:</strong>
      <ul>
        <li>Buy when CFO < -3% and turning up</li>
        <li>Sell when CFO > +3% and turning down</li>
        <li>Exit at zero line or opposite extreme</li>
      </ul>
    </li>
    <li><strong>Trend Following:</strong>
      <ul>
        <li>Long positions only when CFO > 0</li>
        <li>Short positions only when CFO < 0</li>
        <li>Use extremes for profit taking</li>
      </ul>
    </li>
    <li><strong>Divergence Trading:</strong>
      <ul>
        <li>Bullish: Price makes lower lows, CFO makes higher lows</li>
        <li>Bearish: Price makes higher highs, CFO makes lower highs</li>
      </ul>
    </li>
    <li><strong>Volatility Adjustment:</strong> Widen thresholds in volatile markets</li>
  </ul>

  <h3>Advanced Techniques</h3>
  <ul>
    <li><strong>Dynamic Thresholds:</strong> Use Bollinger Bands on CFO for adaptive levels</li>
    <li><strong>Multi-Timeframe:</strong> Confirm signals across different periods</li>
    <li><strong>Regression Channel:</strong> Combine with regression bands for context</li>
    <li><strong>Pattern Recognition:</strong> CFO forms similar patterns to price</li>
  </ul>

  <h2>Practical Application</h2>
  
  <h3>Strengths</h3>
  <ul>
    <li>Accounts for underlying trend in overbought/oversold readings</li>
    <li>Percentage format allows easy comparison across markets</li>
    <li>Statistical basis provides objective signals</li>
    <li>Works well in trending and ranging markets</li>
    <li>Early reversal signals at extremes</li>
  </ul>

  <h3>Limitations</h3>
  <ul>
    <li>Can remain at extremes in strong trends</li>
    <li>Sensitive to period selection</li>
    <li>May whipsaw in choppy markets</li>
    <li>Assumes linear trend (not always valid)</li>
    <li>Requires sufficient data for accurate regression</li>
  </ul>

  <h2>Combination with Other Indicators</h2>
  <p>CFO works best when combined with:</p>
  <ul>
    <li><strong>Linear Regression Channels:</strong> Visual context for CFO readings</li>
    <li><strong>RSI:</strong> Compare momentum readings for confirmation</li>
    <li><strong>Volume:</strong> Validate CFO signals with volume patterns</li>
    <li><strong>ATR:</strong> Adjust CFO thresholds based on volatility</li>
    <li><strong>Moving Averages:</strong> Trend filter for CFO signals</li>
  </ul>

  <h2>Example Usage</h2>
  <p>Code examples will be available once the Rust implementation is complete.</p>
  </div>

  <h2>Mathematical Background</h2>
  <p>
    The Chande Forecast Oscillator leverages the power of linear regression to create a dynamic equilibrium line that 
    adapts to the underlying trend. Unlike fixed moving averages, the regression line considers the relationship 
    between time and price, providing a more accurate representation of where prices "should" be based on recent 
    behavior. This statistical approach gives the CFO its edge in identifying genuine overbought and oversold conditions.
  </p>
  <p>
    The percentage-based output is particularly clever, as it normalizes the deviation across different price levels 
    and volatility regimes. A 3% deviation is equally significant whether the asset trades at $10 or $1000, making 
    the CFO universally applicable. This normalization, combined with the trend-adjusted nature of the indicator, 
    makes it one of the more sophisticated momentum oscillators available to traders.
  </p>

</IndicatorLayout>