---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'correlation_cycle';
const indicatorName = 'Correlation Cycle Indicator';
const description = `The Correlation Cycle Indicator is an advanced technical tool that measures the cyclical relationship between price movements and time. It identifies recurring patterns and cycles in market behavior by analyzing the correlation between current price action and historical price patterns, helping traders anticipate potential turning points based on market rhythms.`;
const parameters = [
  {
    "name": "period",
    "type": "number",
    "default": 20,
    "min": 10,
    "max": 200,
    "description": "Primary cycle period for correlation analysis"
  },
  {
    "name": "lookback",
    "type": "number",
    "default": 50,
    "min": 20,
    "max": 500,
    "description": "Historical lookback period for pattern matching"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2>Overview</h2>
  <p>
    The Correlation Cycle Indicator represents a sophisticated approach to market analysis by combining correlation 
    analysis with cycle theory. Rather than simply identifying fixed-period cycles, it dynamically measures how 
    current price patterns correlate with historical patterns at various cycle lengths. This approach reveals when 
    markets are following predictable cyclical behavior versus when they're breaking from established patterns.
  </p>
  <p>
    This indicator is particularly valuable for traders who understand that markets often exhibit repetitive behavior 
    due to fundamental factors like seasonal patterns, economic cycles, and institutional trading rhythms. By 
    quantifying these correlations, the indicator helps identify when a market is likely to continue its cyclical 
    pattern or when a cycle breakdown might signal a significant change in market dynamics.
  </p>

  <h2>How It Works</h2>
  <p>The Correlation Cycle calculation involves several sophisticated steps:</p>
  <ol>
    <li><strong>Cycle Extraction:</strong> Identify dominant cycle periods in price data</li>
    <li><strong>Pattern Matching:</strong> Compare current price pattern with historical cycles</li>
    <li><strong>Correlation Calculation:</strong> Measure correlation strength at each cycle length</li>
    <li><strong>Composite Score:</strong> Combine multiple cycle correlations into single indicator</li>
  </ol>
  
  <div class="not-prose bg-gray-100 dark:bg-gray-800 p-4 rounded-lg my-4 border border-gray-200 dark:border-gray-700">
    <p class="font-mono text-sm mb-0 text-gray-800 dark:text-gray-200">
      For each cycle length n:<br/>
      Current_Pattern = Price[0] to Price[n-1]<br/>
      <br/>
      For each historical position i:<br/>
      Historical_Pattern = Price[i] to Price[i+n-1]<br/>
      <br/>
      Correlation[i] = Pearson_Correlation(Current_Pattern, Historical_Pattern)<br/>
      <br/>
      Cycle_Strength = Average(Top_Correlations)<br/>
      <br/>
      Correlation_Cycle = Weighted_Average(Cycle_Strength[all cycles])<br/>
      <br/>
      Range: -1 to +1<br/>
      Where:<br/>
      +1 = Perfect cyclical repetition<br/>
      0 = No cyclical pattern<br/>
      -1 = Perfect inverse cycle
    </p>
  </div>

  <h2>Key Features</h2>
  <ul>
    <li><strong>Dynamic Cycle Detection:</strong> Adapts to changing market rhythms</li>
    <li><strong>Pattern Recognition:</strong> Identifies repeating price patterns</li>
    <li><strong>Multi-Cycle Analysis:</strong> Considers multiple cycle lengths simultaneously</li>
    <li><strong>Correlation Strength:</strong> Quantifies how well patterns match</li>
  </ul>

  <h2>Interpretation & Trading Signals</h2>
  
  <h3>Correlation Levels</h3>
  <div class="not-prose bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg my-4 border border-blue-200 dark:border-blue-800">
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Reading the Indicator:</h4>
    <ul class="list-disc list-inside mb-4 text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100"&gt;0.7 to 1.0:</strong> Strong cyclical behavior - High predictability</li>
      <li><strong class="text-gray-900 dark:text-gray-100"&gt;0.4 to 0.7:</strong> Moderate cycles - Some predictability</li>
      <li><strong class="text-gray-900 dark:text-gray-100"&gt;0.0 to 0.4:</strong> Weak cycles - Low predictability</li>
      <li><strong class="text-gray-900 dark:text-gray-100"&gt;-0.4 to 0.0:</strong> Inverse weak cycles</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Below -0.4:</strong> Strong inverse cycles - Contrarian signals</li>
    </ul>
    
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Cycle Signals:</h4>
    <ul class="list-disc list-inside text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Rising Correlation:</strong> Cycle strengthening - Follow the pattern</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Falling Correlation:</strong> Cycle breaking down - Expect changes</li>
      <li><strong class="text-gray-900 dark:text-gray-100">High Stable:</strong> Reliable cycle - Trade with confidence</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Low Volatile:</strong> No clear cycle - Avoid pattern-based trades</li>
    </ul>
  </div>

  <h3>Trading Strategies</h3>
  <ul>
    <li><strong>Cycle Following:</strong>
      <ul>
        <li>Trade in direction of historical pattern when correlation &gt; 0.7</li>
        <li>Use historical cycle highs/lows as targets</li>
        <li>Exit when correlation drops below 0.5</li>
      </ul>
    </li>
    <li><strong>Cycle Breakout:</strong>
      <ul>
        <li>When correlation drops from high to low rapidly</li>
        <li>Indicates cycle failure - potential trend change</li>
        <li>Trade the breakout from expected pattern</li>
      </ul>
    </li>
    <li><strong>Inverse Cycle Trading:</strong>
      <ul>
        <li>Strong negative correlation suggests reversal pattern</li>
        <li>Trade opposite to historical pattern</li>
        <li>Useful in mean-reverting markets</li>
      </ul>
    </li>
    <li><strong>Cycle Confluence:</strong> Combine multiple cycle periods for stronger signals</li>
  </ul>

  <h3>Advanced Techniques</h3>
  <ul>
    <li><strong>Dominant Cycle Extraction:</strong> Focus on the strongest cycle period</li>
    <li><strong>Phase Analysis:</strong> Determine where we are in the current cycle</li>
    <li><strong>Cycle Harmonics:</strong> Look for cycles that are multiples of each other</li>
    <li><strong>Cross-Market Cycles:</strong> Compare cycles across related markets</li>
  </ul>

  <h2>Practical Application</h2>
  
  <h3>Strengths</h3>
  <ul>
    <li>Identifies hidden market rhythms</li>
    <li>Adapts to changing cycle periods</li>
    <li>Quantifies pattern reliability</li>
    <li>Works across different timeframes</li>
    <li>Provides early warning of cycle changes</li>
  </ul>

  <h3>Limitations</h3>
  <ul>
    <li>Complex calculation requires significant data</li>
    <li>May find spurious correlations in random data</li>
    <li>Less effective in strongly trending markets</li>
    <li>Cycles can change without warning</li>
    <li>Requires understanding of cycle theory</li>
  </ul>

  <h2>Combination with Other Indicators</h2>
  <p>The Correlation Cycle Indicator works best when combined with:</p>
  <ul>
    <li><strong>Fourier Analysis:</strong> Confirm dominant cycle periods</li>
    <li><strong>RSI/Stochastic:</strong> Time entries at cycle extremes</li>
    <li><strong>Volume:</strong> Confirm cycle turns with volume patterns</li>
    <li><strong>Seasonality:</strong> Align with known seasonal patterns</li>
    <li><strong>Momentum Indicators:</strong> Confirm cycle direction with momentum</li>
  </ul>

  <h2>Example Usage</h2>
  <p>Code examples will be available once the Rust implementation is complete.</p>

  <h2>Mathematical Background</h2>
  <p>
    The Correlation Cycle Indicator employs advanced statistical techniques to identify and quantify market cycles. 
    At its core, it uses sliding window correlation analysis, where windows of price data are compared across 
    different time periods. The use of Pearson correlation ensures that the shape of the pattern matters more than 
    the absolute price levels, making the indicator adaptive to different market conditions.
  </p>
  <p>
    The mathematical elegance lies in the multi-scale approach. By analyzing correlations at multiple cycle lengths 
    simultaneously, the indicator captures both dominant cycles and their harmonics. The weighted averaging of these 
    correlations creates a smooth indicator that responds to genuine cycle changes while filtering out noise. This 
    approach is grounded in spectral analysis theory but implemented in a more intuitive correlation framework.
  </p>

</IndicatorLayout>