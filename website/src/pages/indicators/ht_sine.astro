---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'ht_sine';
const indicatorName = 'Hilbert Transform - SineWave';
const description = `The Hilbert Transform SineWave indicator generates two sinusoidal outputs - Sine and LeadSine - that oscillate in sync with the dominant market cycle, providing clear visual signals for cycle tops and bottoms with the LeadSine offering advanced warning of cycle turns.`;
const parameters: Array<{
  name: string;
  type: 'number' | 'boolean';
  default: any;
  min?: number;
  max?: number;
  description?: string;
}> = [];  // Hilbert Transform indicators are typically parameter-free
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2 id="overview">Overview</h2>
  <p>
    The Hilbert Transform - SineWave indicator, developed by John Ehlers, transforms the dominant 
    cycle phase into two smooth sine wave outputs. The primary Sine output represents the current 
    position within the market cycle, while the LeadSine output is advanced by 45 degrees, providing 
    early signals of impending cycle turns. These waves oscillate between -1 and +1, making cycle 
    tops and bottoms visually obvious.
  </p>
  <p>
    What makes this indicator particularly powerful is its ability to adapt to the current market 
    cycle automatically. Unlike fixed-period oscillators, the SineWave indicator adjusts its 
    frequency based on the measured dominant cycle, always showing exactly one complete sine wave 
    per market cycle. The crossovers between Sine and LeadSine provide high-probability turning 
    point signals when the market is in a cycling mode.
  </p>

  <h2 id="interpretation">Interpretation</h2>
  <h3>Wave Components</h3>
  <ul>
    <li><strong>Sine:</strong> Current cycle position as a sine wave (-1 to +1)</li>
    <li><strong>LeadSine:</strong> Sine wave advanced by 45°, providing early signals</li>
    <li><strong>Crossovers:</strong> LeadSine crossing Sine indicates cycle turns</li>
    <li><strong>Extremes:</strong> Values near ±1 indicate cycle peaks/troughs</li>
  </ul>

  <h3>Trading Signals</h3>
  <ul>
    <li><strong>Buy signal:</strong> LeadSine crosses above Sine (cycle bottom)</li>
    <li><strong>Sell signal:</strong> LeadSine crosses below Sine (cycle top)</li>
    <li><strong>Overbought:</strong> Both waves near +1</li>
    <li><strong>Oversold:</strong> Both waves near -1</li>
  </ul>

  <h3>Market Conditions</h3>
  <ul>
    <li><strong>Cycling market:</strong> Clear, smooth sine waves with regular crossovers</li>
    <li><strong>Trending market:</strong> Waves may flatline at extremes or show irregular patterns</li>
    <li><strong>Transition:</strong> Waves converging indicates potential trend start</li>
    <li><strong>High reliability:</strong> Wide separation between waves at turns</li>
  </ul>

  <h2 id="calculation">Calculation</h2>
  <p>The SineWave calculation process:</p>
  <ol>
    <li><strong>Calculate Dominant Cycle Phase:</strong> Using Hilbert Transform</li>
    <li><strong>Measure Dominant Cycle Period:</strong> From phase rate of change</li>
    <li><strong>Generate Sine Wave:</strong> <code>Sine = sin(Phase)</code></li>
    <li><strong>Generate LeadSine:</strong> <code>LeadSine = sin(Phase + 45°)</code></li>
    <li><strong>Normalize Output:</strong> Ensure range is exactly -1 to +1</li>
    <li><strong>Apply Smoothing:</strong> 3-bar WMA for noise reduction</li>
  </ol>
  <p>
    The 45-degree lead is chosen because it provides optimal advance warning while maintaining 
    high correlation with actual turns. At this lead angle, the LeadSine crosses zero exactly 
    when the Sine reaches its maximum rate of change, coinciding with momentum shifts in price.
  </p>

  <h2 id="parameters">Parameters</h2>
  <p>
    The Hilbert Transform SineWave has no user-adjustable parameters. The indicator automatically 
    adapts to the dominant cycle period through the Hilbert Transform process. This self-adaptive 
    design ensures the indicator always displays exactly one sine wave per dominant market cycle, 
    regardless of whether that cycle is 10 bars or 40 bars.
  </p>
  <p>
    Fixed internal settings:
  </p>
  <ul>
    <li><strong>Lead angle:</strong> 45 degrees (π/4 radians)</li>
    <li><strong>Output range:</strong> -1 to +1</li>
    <li><strong>Smoothing:</strong> 3-bar WMA on final output</li>
    <li><strong>Initialization:</strong> ~50 bars for Hilbert Transform</li>
  </ul>

  <h2 id="returns">Returns & Output</h2>
  <p>The indicator returns two synchronized sine waves:</p>
  <ul>
    <li><strong>Sine:</strong> Primary sine wave output</li>
    <li><strong>LeadSine:</strong> Leading sine wave (45° advanced)</li>
    <li><strong>Type:</strong> Two arrays of floating-point numbers</li>
    <li><strong>Range:</strong> -1.0 to +1.0 (normalized)</li>
    <li><strong>Frequency:</strong> Automatically matches dominant cycle</li>
    <li><strong>Initial values:</strong> Requires ~50 bars to stabilize</li>
  </ul>

  <h2 id="usage">Example Usage</h2>
  <h3>Rust Implementation</h3>
  <pre><code class="language-rust"> // Rust implementation example will be added here
</code></pre>

  <h3>Python Integration</h3> <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h2 id="use-cases"> Common Use Cases</h2> <h3>1. Cycle Trading System</h3> <p>Trade based on SineWave crossovers:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h3>2. Momentum Confirmation</h3> <p>Use wave velocity for momentum analysis:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h3>3. Multi-Indicator Confirmation</h3> <p>Combine with other Hilbert indicators:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h2 id="edge-cases"> Edge Cases & Errors</h2>
  <h3>Common Issues</h3>
  <ul>
    <li><strong>Trending markets:</strong> Waves may flatline at extremes for extended periods</li>
    <li><strong>Transition periods:</strong> Erratic behavior when market shifts between cycling and trending</li>
    <li><strong>Whipsaws:</strong> Multiple crossovers in choppy markets</li>
    <li><strong>Initialization:</strong> Requires ~50 bars for accurate output</li>
  </ul>

  <h3>Best Practices</h3>
  <ul>
    <li>Confirm market is cycling before taking signals</li>
    <li>Use wave separation as signal quality filter</li>
    <li>Avoid signals when waves are converging</li>
    <li>Combine with dominant cycle period for validation</li>
    <li>Set minimum wave velocity thresholds</li>
    <li>Use stops at opposite wave extremes</li>
  </ul>

  <h2 id="references">References</h2>
  <ul>
    <li>Ehlers, J. F. (2001). <em>Rocket Science for Traders</em>. John Wiley & Sons.</li>
    <li>Ehlers, J. F. (2013). <em>Cycle Analytics for Traders</em>. John Wiley & Sons.</li>
    <li>Mesa and Sine Wave indicator (MESA) original research</li>
    <li>Applications of phase-based indicators in trading systems</li>
  </ul>
</IndicatorLayout>
