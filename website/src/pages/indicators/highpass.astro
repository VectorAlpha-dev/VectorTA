---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'highpass';
const indicatorName = 'High Pass Filter';
const description = `The High Pass Filter is a signal processing technique that removes low-frequency components from price data, emphasizing short-term fluctuations and rapid price changes while filtering out long-term trends.`;
const parameters = [
  {
    "name": "period",
    "type": "number",
    "default": 48,
    "min": 5,
    "max": 200,
    "description": "Cutoff period for the filter"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2 id="overview">Overview</h2>
  <p>
    The High Pass Filter is a digital signal processing technique adapted for financial markets that 
    removes low-frequency (long-term trend) components from price data while preserving high-frequency 
    (short-term) components. This makes it particularly useful for identifying cycles, oscillations, 
    and rapid price movements that might be obscured by dominant trends.
  </p>
  <p>
    Developed by John Ehlers as part of his work on applying digital signal processing to trading, 
    the High Pass Filter acts as the opposite of a moving average. While moving averages smooth out 
    short-term fluctuations to reveal trends, the High Pass Filter removes trends to reveal 
    short-term fluctuations and cycles.
  </p>

  <h2 id="interpretation">Interpretation</h2>
  <h3>Signal Characteristics</h3>
  <ul>
    <li><strong>Zero line crossings:</strong> Indicate potential cycle turns or momentum shifts</li>
    <li><strong>Peaks and troughs:</strong> Mark cycle highs and lows in detrended data</li>
    <li><strong>Amplitude:</strong> Larger amplitudes suggest stronger cyclic movements</li>
    <li><strong>Frequency:</strong> Distance between peaks indicates dominant cycle length</li>
  </ul>

  <h3>Trading Signals</h3>
  <ul>
    <li><strong>Buy signal:</strong> When the filter crosses above zero after a trough</li>
    <li><strong>Sell signal:</strong> When the filter crosses below zero after a peak</li>
    <li><strong>Cycle identification:</strong> Regular oscillations reveal market cycles</li>
    <li><strong>Divergence:</strong> Filter diverging from price can signal potential reversals</li>
  </ul>

  <h3>Market Applications</h3>
  <ul>
    <li><strong>Cycle trading:</strong> Identify and trade market cycles independent of trend</li>
    <li><strong>Mean reversion:</strong> Extreme readings often precede price reversions</li>
    <li><strong>Noise filtering:</strong> Remove trend to focus on shorter-term movements</li>
    <li><strong>Oscillator input:</strong> Use as input for other cycle-based indicators</li>
  </ul>

  <h2 id="calculation">Calculation</h2>
  <p>The High Pass Filter uses the following calculation:</p>
  <ol>
    <li>Calculate the filter coefficient: <code>α = (cos(√2 * π / period) + sin(√2 * π / period) - 1) / cos(√2 * π / period)</code></li>
    <li>Apply the filter recursively: <code>HP[i] = (1 - α/2)² * (price[i] - 2*price[i-1] + price[i-2]) + 2*(1-α)*HP[i-1] - (1-α)²*HP[i-2]</code></li>
    <li>Initialize with zeros for the first two values</li>
  </ol>
  <p>
    The coefficient α determines the cutoff frequency. Lower periods result in less filtering 
    (more high-frequency content), while higher periods filter out more of the short-term movements.
  </p>

  <h2 id="parameters">Parameters</h2>
  <h3>Period (default: 48)</h3>
  <p>
    The cutoff period determines which frequencies are filtered out. Price movements with periods 
    longer than this value are attenuated, while shorter period movements pass through.
  </p>
  <ul>
    <li><strong>Short period (5-20):</strong> Preserves very short-term movements, more responsive</li>
    <li><strong>Medium period (20-50):</strong> Balanced filtering, good for swing trading</li>
    <li><strong>Long period (50-100):</strong> Removes all but the shortest cycles, very smooth</li>
  </ul>
  <p>
    Ehlers recommends using a period of 48 for daily data to filter out movements longer than 
    about 2 months while preserving shorter cycles.
  </p>

  <h2 id="returns">Returns & Output</h2>
  <p>The High Pass Filter returns an oscillating series centered around zero:</p>
  <ul>
    <li><strong>Type:</strong> Array of floating-point numbers</li>
    <li><strong>Range:</strong> Typically oscillates within ±5% of price range</li>
    <li><strong>Center:</strong> Zero (trends are removed)</li>
    <li><strong>Initial values:</strong> First two values are typically zero</li>
    <li><strong>Interpretation:</strong> Positive values indicate price above detrended average, negative below</li>
  </ul>

  <h2 id="usage">Example Usage</h2>
  <h3>Rust Implementation</h3>
  <pre><code class="language-rust"> // Rust implementation example will be added here
</code></pre>

  <h3>Python Integration</h3> <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h2 id="use-cases"> Common Use Cases</h2> <h3>1. Cycle Extraction</h3> <p>Remove trend to analyze pure cycles:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h3>2. Detrended Analysis</h3> <p>Analyze price movements without trend bias:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h3>3. Oscillator Enhancement</h3> <p>Use as input to other indicators:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h2 id="edge-cases"> Edge Cases & Errors</h2>
  <h3>Common Issues</h3>
  <ul>
    <li><strong>Initialization:</strong> First few values may be unstable due to filter startup</li>
    <li><strong>Lag:</strong> Despite being "high pass," still has some lag in detecting turns</li>
    <li><strong>Amplitude variation:</strong> Output amplitude varies with market volatility</li>
    <li><strong>False signals:</strong> Choppy markets can produce many zero-line crosses</li>
  </ul>

  <h3>Best Practices</h3>
  <ul>
    <li>Wait for filter to stabilize (at least 2*period bars)</li>
    <li>Combine with trend indicators for context</li>
    <li>Adjust period based on dominant market cycle</li>
    <li>Use amplitude thresholds to filter weak signals</li>
    <li>Consider market regime when interpreting signals</li>
  </ul>

  <h2 id="references">References</h2>
  <ul>
    <li>Ehlers, J. F. (2001). <em>Rocket Science for Traders</em>. John Wiley & Sons.</li>
    <li>Ehlers, J. F. (2013). <em>Cycle Analytics for Traders</em>. John Wiley & Sons.</li>
    <li>Digital Signal Processing theory and applications</li>
    <li>Comparison of High Pass, Band Pass, and Low Pass filters in trading</li>
  </ul>
</IndicatorLayout>
