---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'kst';
const indicatorName = 'Know Sure Thing (KST)';
const description = `The Know Sure Thing (KST) is a momentum oscillator developed by Martin Pring that combines multiple rate-of-change calculations across different timeframes, providing a smoothed indicator that identifies major trend changes and generates reliable trading signals.`;
const parameters = [
  {
    "name": "roc1_period",
    "type": "number",
    "default": 10,
    "min": 5,
    "max": 50,
    "description": "First ROC period (shortest)"
  },
  {
    "name": "roc2_period",
    "type": "number",
    "default": 15,
    "min": 10,
    "max": 75,
    "description": "Second ROC period"
  },
  {
    "name": "roc3_period",
    "type": "number",
    "default": 20,
    "min": 15,
    "max": 100,
    "description": "Third ROC period"
  },
  {
    "name": "roc4_period",
    "type": "number",
    "default": 30,
    "min": 20,
    "max": 150,
    "description": "Fourth ROC period (longest)"
  },
  {
    "name": "sma1_period",
    "type": "number",
    "default": 10,
    "min": 3,
    "max": 30,
    "description": "First ROC smoothing period"
  },
  {
    "name": "sma2_period",
    "type": "number",
    "default": 10,
    "min": 3,
    "max": 30,
    "description": "Second ROC smoothing period"
  },
  {
    "name": "sma3_period",
    "type": "number",
    "default": 10,
    "min": 3,
    "max": 30,
    "description": "Third ROC smoothing period"
  },
  {
    "name": "sma4_period",
    "type": "number",
    "default": 15,
    "min": 5,
    "max": 40,
    "description": "Fourth ROC smoothing period"
  },
  {
    "name": "signal_period",
    "type": "number",
    "default": 9,
    "min": 3,
    "max": 30,
    "description": "Signal line SMA period"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2 id="overview">Overview</h2>
  <p>
    The Know Sure Thing (KST) is a sophisticated momentum oscillator developed by Martin Pring that 
    addresses the limitations of single-timeframe momentum indicators. By combining four different 
    rate-of-change (ROC) calculations, each smoothed and weighted according to their timeframe, KST 
    provides a comprehensive view of market momentum across multiple time horizons.
  </p>
  <p>
    The indicator's name reflects its reliability in identifying significant trend changes. KST excels 
    at filtering out short-term noise while remaining responsive to meaningful momentum shifts. It's 
    particularly effective for identifying major market turns and can be used across all timeframes, 
    from intraday to long-term investing. The signal line crossovers and divergences provide clear, 
    actionable trading signals.
  </p>

  <h2 id="interpretation">Interpretation</h2>
  <h3>Signal Components</h3>
  <ul>
    <li><strong>KST Line:</strong> Weighted sum of four smoothed ROC calculations</li>
    <li><strong>Signal Line:</strong> 9-period SMA of the KST line</li>
    <li><strong>Zero Line:</strong> Centerline separating positive and negative momentum</li>
    <li><strong>Crossovers:</strong> KST crossing signal line generates trading signals</li>
  </ul>

  <h3>Trading Signals</h3>
  <ul>
    <li><strong>Bullish crossover:</strong> KST crosses above signal line</li>
    <li><strong>Bearish crossover:</strong> KST crosses below signal line</li>
    <li><strong>Zero line cross:</strong> Confirms trend direction changes</li>
    <li><strong>Divergences:</strong> Price vs KST divergences signal reversals</li>
    <li><strong>Overbought/Oversold:</strong> Extreme readings suggest reversals</li>
  </ul>

  <h3>Market Conditions</h3>
  <ul>
    <li><strong>Trending markets:</strong> KST above/below zero confirms trend</li>
    <li><strong>Turning points:</strong> Signal line crosses identify major turns</li>
    <li><strong>Momentum shifts:</strong> KST slope changes precede price moves</li>
    <li><strong>Cycle analysis:</strong> Multiple timeframes capture market cycles</li>
  </ul>

  <h2 id="calculation">Calculation</h2>
  <p>The KST calculation combines four rate-of-change measurements:</p>
  <ol>
    <li><strong>Calculate Four ROCs:</strong>
      <ul>
        <li>ROC1 = (Close - Close[10 periods ago]) / Close[10 periods ago] × 100</li>
        <li>ROC2 = (Close - Close[15 periods ago]) / Close[15 periods ago] × 100</li>
        <li>ROC3 = (Close - Close[20 periods ago]) / Close[20 periods ago] × 100</li>
        <li>ROC4 = (Close - Close[30 periods ago]) / Close[30 periods ago] × 100</li>
      </ul>
    </li>
    <li><strong>Smooth Each ROC:</strong>
      <ul>
        <li>ROCMA1 = SMA(ROC1, 10)</li>
        <li>ROCMA2 = SMA(ROC2, 10)</li>
        <li>ROCMA3 = SMA(ROC3, 10)</li>
        <li>ROCMA4 = SMA(ROC4, 15)</li>
      </ul>
    </li>
    <li><strong>Calculate Weighted Sum:</strong>
      <ul>
        <li>KST = (ROCMA1 × 1) + (ROCMA2 × 2) + (ROCMA3 × 3) + (ROCMA4 × 4)</li>
        <li>Weights emphasize longer timeframes</li>
      </ul>
    </li>
    <li><strong>Calculate Signal Line:</strong>
      <ul>
        <li>Signal = SMA(KST, 9)</li>
      </ul>
    </li>
  </ol>
  <p>
    The weighting scheme (1:2:3:4) gives more importance to longer-term momentum, making KST 
    particularly effective at identifying major trend changes while filtering out short-term noise.
  </p>

  <h2 id="parameters">Parameters</h2>
  <ul>
    <li>
      <strong>ROC Periods (defaults: 10, 15, 20, 30):</strong> The four rate-of-change lookback 
      periods. These capture momentum across different timeframes. The standard settings work well 
      for daily charts. For weekly charts, use 10, 13, 15, 20. For monthly charts, use 9, 12, 18, 24. 
      Maintain the progressive relationship between periods.
    </li>
    <li>
      <strong>SMA Periods (defaults: 10, 10, 10, 15):</strong> Smoothing periods for each ROC. 
      These reduce noise in the rate-of-change calculations. The fourth period is typically longer 
      to provide extra smoothing for the longest-term component. Adjust based on desired sensitivity.
    </li>
    <li>
      <strong>Signal Period (default: 9):</strong> The smoothing period for the signal line. 
      Similar to MACD, 9 is standard but can be adjusted. Shorter periods (5-7) generate more 
      signals, while longer periods (12-15) reduce whipsaws but may lag at turning points.
    </li>
  </ul>

  <h2 id="returns">Returns & Output</h2>
  <p>The indicator returns two arrays:</p>
  <ul>
    <li><strong>KST values:</strong> The main oscillator line</li>
    <li><strong>Signal values:</strong> The smoothed signal line</li>
    <li><strong>Range:</strong> Typically oscillates between -50 and +50</li>
    <li><strong>Zero-centered:</strong> Positive = bullish momentum, Negative = bearish</li>
    <li><strong>Initial values:</strong> Requires at least 30 + 15 bars for stable calculation</li>
  </ul>

  <h2 id="usage">Example Usage</h2>
  <h3>Rust Implementation</h3>
  <pre><code class="language-rust"> // Rust implementation example will be added here
</code></pre>

  <h3>Python Integration</h3> <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h2 id="use-cases"> Common Use Cases</h2> <h3>1. Major Trend Identification</h3> <p>Using KST for long-term trend following:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h3>2. Divergence Trading Strategy</h3> <p>Trading divergences between price and KST:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h3>3. Multi-Timeframe KST System</h3> <p>Combining KST from multiple timeframes:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h2 id="edge-cases"> Edge Cases & Errors</h2>
  <h3>Common Issues</h3>
  <ul>
    <li><strong>Initialization period:</strong> Requires significant historical data (45+ bars)</li>
    <li><strong>Parameter relationships:</strong> ROC periods must maintain proper progression</li>
    <li><strong>Whipsaws in ranges:</strong> Multiple crossovers in sideways markets</li>
    <li><strong>Lag at extremes:</strong> May be slow to signal after extended trends</li>
  </ul>

  <h3>Best Practices</h3>
  <ul>
    <li>Use standard parameters for daily charts, adjust for other timeframes</li>
    <li>Confirm signals with price action (support/resistance breaks)</li>
    <li>Look for divergences at market extremes for high-probability trades</li>
    <li>Combine with trend-following indicators for filtering</li>
    <li>Monitor signal line distance for momentum strength</li>
    <li>Use zero-line position as trend filter</li>
  </ul>

  <h2 id="references">References</h2>
  <ul>
    <li>Pring, M. J. (1991). <em>Technical Analysis Explained</em>. McGraw-Hill.</li>
    <li>Pring, M. J. (1992). "Summed Rate of Change (KST)" - <em>Stocks & Commodities Magazine</em></li>
    <li>Multi-timeframe momentum analysis techniques</li>
    <li>Rate of Change indicators and momentum oscillators</li>
  </ul>
</IndicatorLayout>
