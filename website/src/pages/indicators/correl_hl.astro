---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'correl_hl';
const indicatorName = 'High-Low Correlation';
const description = `The High-Low Correlation indicator measures the correlation between high and low prices over a specified period. This unique indicator helps identify market structure changes, volatility patterns, and potential trend reversals by analyzing how synchronized the highs and lows are moving relative to each other.`;
const parameters = [
  {
    "name": "period",
    "type": "number",
    "default": 14,
    "min": 2,
    "max": 200,
    "description": "Lookback period for correlation calculation"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2>Overview</h2>
  <p>
    The High-Low Correlation indicator provides unique insights into market structure by measuring how closely highs 
    and lows move together. In normal trending markets, highs and lows tend to move in the same direction with high 
    correlation. However, during market transitions, consolidations, or volatility expansions, this correlation can 
    break down, providing early warnings of potential changes in market behavior.
  </p>
  <p>
    This indicator is particularly valuable for understanding market quality and structure. High correlation suggests 
    orderly price movement and healthy trends, while low or negative correlation can indicate market stress, 
    distribution/accumulation phases, or impending volatility changes. Unlike traditional momentum oscillators, 
    it focuses on the internal price structure rather than directional movement.
  </p>

  <h2>How It Works</h2>
  <p>The High-Low Correlation calculation involves:</p>
  <ol>
    <li><strong>Collect Data:</strong> Gather high and low prices for the lookback period</li>
    <li><strong>Calculate Means:</strong> Find average high and average low</li>
    <li><strong>Compute Deviations:</strong> Calculate deviations from means</li>
    <li><strong>Apply Correlation Formula:</strong> Standard statistical correlation calculation</li>
  </ol>
  
  <div class="not-prose bg-gray-100 dark:bg-gray-800 p-4 rounded-lg my-4 border border-gray-200 dark:border-gray-700">
    <p class="font-mono text-sm mb-0 text-gray-800 dark:text-gray-200"> Mean_High = Σ(High) / n<br/>
      Mean_Low = Σ(Low) / n<br/>
      <br/>
      Covariance = Σ((High[i] - Mean_High) × (Low[i] - Mean_Low)) / n<br/>
      <br/>
      StdDev_High = √(Σ((High[i] - Mean_High)²) / n)<br/>
      StdDev_Low = √(Σ((Low[i] - Mean_Low)²) / n)<br/>
      <br/>
      Correlation = Covariance / (StdDev_High × StdDev_Low)<br/>
      <br/>
      Range: -1 to +1<br/>
      Where:<br/>
      +1 = Perfect positive correlation<br/>
      0 = No correlation<br/>
      -1 = Perfect negative correlation
    </p>
  </div>

  <h2>Key Features</h2>
  <ul>
    <li><strong>Market Structure Analysis:</strong> Reveals internal price dynamics</li>
    <li><strong>Volatility Insight:</strong> Correlation changes often precede volatility shifts</li>
    <li><strong>Trend Quality:</strong> High correlation confirms healthy trends</li>
    <li><strong>Early Warning:</strong> Breakdown in correlation warns of potential reversals</li>
  </ul>

  <h2>Interpretation & Trading Signals</h2>
  
  <h3>Correlation Levels</h3>
  <div class="not-prose bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg my-4 border border-blue-200 dark:border-blue-800">
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100"> Reading the Indicator:</h4> <ul class="list-disc list-inside mb-4 text-gray-700 dark:text-gray-300"> <li><strong class="text-gray-900 dark:text-gray-100">0.8 to 1.0:</strong> Very high correlation - Strong trending market</li>
      <li><strong class="text-gray-900 dark:text-gray-100">0.5 to 0.8:</strong> Moderate correlation - Normal market conditions</li>
      <li><strong class="text-gray-900 dark:text-gray-100">0.2 to 0.5:</strong> Low correlation - Market uncertainty</li>
      <li><strong class="text-gray-900 dark:text-gray-100">-0.2 to 0.2:</strong> No correlation - Choppy, directionless</li>
      <li><strong class="text-gray-900 dark:text-gray-100"> Below -0.2:</strong> Negative correlation - Unusual market stress</li>
    </ul>
    
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100"> Market Implications:</h4> <ul class="list-disc list-inside text-gray-700 dark:text-gray-300"> <li><strong class="text-gray-900 dark:text-gray-100"> Rising Correlation:</strong> Market becoming more orderly</li>
      <li><strong class="text-gray-900 dark:text-gray-100"> Falling Correlation:</strong> Market structure breaking down</li>
      <li><strong class="text-gray-900 dark:text-gray-100"> Extreme High:</strong> Potential for mean reversion</li>
      <li><strong class="text-gray-900 dark:text-gray-100"> Extreme Low:</strong> Volatility expansion likely</li>
    </ul>
  </div>

  <h3>Trading Strategies</h3>
  <ul>
    <li><strong>Trend Confirmation:</strong>
      <ul>
        <li>High correlation (&gt;0.7) confirms trend strength</li>
        <li>Trade in trend direction when correlation is high</li>
        <li>Reduce position size when correlation drops</li>
      </ul>
    </li>
    <li><strong>Volatility Breakout:</strong>
      <ul>
        <li>Low correlation often precedes volatility expansion</li>
        <li>Prepare for breakout when correlation &lt; 0.3</li>
        <li>Use options strategies during low correlation</li>
      </ul>
    </li>
    <li><strong>Mean Reversion:</strong>
      <ul>
        <li>Extreme high correlation (&gt;0.9) may signal exhaustion</li>
        <li>Look for reversal patterns when correlation peaks</li>
      </ul>
    </li>
    <li><strong>Market Regime Filter:</strong> Only trade certain strategies based on correlation level</li>
  </ul>

  <h3>Advanced Techniques</h3>
  <ul>
    <li><strong>Correlation Divergence:</strong> Price making new highs with falling correlation</li>
    <li><strong>Correlation Cycles:</strong> Track typical correlation patterns for the market</li>
    <li><strong>Multi-Period Analysis:</strong> Compare short and long-term correlations</li>
    <li><strong>Cross-Market:</strong> Compare correlations across related markets</li>
  </ul>

  <h2>Practical Application</h2>
  
  <h3>Strengths</h3>
  <ul>
    <li>Unique perspective on market structure</li>
    <li>Early warning of volatility changes</li>
    <li>Works across all markets and timeframes</li>
    <li>Not directionally biased</li>
    <li>Complements traditional indicators well</li>
  </ul>

  <h3>Limitations</h3>
  <ul>
    <li>Doesn't provide directional signals</li>
    <li>Can be noisy on short timeframes</li>
    <li>Requires understanding of correlation statistics</li>
    <li>Less intuitive than price-based indicators</li>
    <li>May lag during rapid market changes</li>
  </ul>

  <h2>Combination with Other Indicators</h2>
  <p>High-Low Correlation works best when combined with:</p>
  <ul>
    <li><strong>ATR:</strong> Confirm volatility readings with correlation changes</li>
    <li><strong>ADX:</strong> Use correlation to confirm ADX trend strength readings</li>
    <li><strong>Bollinger Bands:</strong> Low correlation often coincides with band squeezes</li>
    <li><strong>Volume:</strong> Correlation breakdown with high volume is significant</li>
    <li><strong>Market Breadth:</strong> Compare individual stock correlation to index correlation</li>
  </ul>

  <h2>Mathematical Background</h2>
  <p>
    The High-Low Correlation uses Pearson's correlation coefficient, a fundamental statistical measure that quantifies 
    the linear relationship between two variables. In this case, the variables are the high and low prices over time. 
    The correlation coefficient is scale-invariant, meaning it measures the strength of the relationship regardless 
    of the actual price levels.
  </p>
  <p>
    The mathematical beauty of this indicator lies in its ability to capture market microstructure. In efficient, 
    trending markets, highs and lows should move proportionally, maintaining high correlation. When this relationship 
    breaks down, it suggests that the market's price discovery mechanism is changing, often preceding significant 
    moves or volatility shifts. This makes it a valuable tool for understanding not just what prices are doing, 
    but how they're behaving internally.
  </p>

</IndicatorLayout>
