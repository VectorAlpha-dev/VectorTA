---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'hwma';
const indicatorName = 'Henderson Weighted Moving Average';
const description = `The Henderson Weighted Moving Average (HWMA) is a symmetric weighted moving average designed to reduce lag while maintaining smoothness, using weights derived from Henderson's graduation formula originally developed for actuarial science and time series analysis.`;
const parameters = [
  {
    "name": "period",
    "type": "number",
    "default": 14,
    "min": 5,
    "max": 200,
    "description": "Lookback period (must be odd number >= 5)"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2 id="overview">Overview</h2>
  <p>
    The Henderson Weighted Moving Average (HWMA) is a sophisticated smoothing technique that applies 
    symmetric weights to price data, with the highest weight at the center and weights tapering off 
    towards the edges. Originally developed by Robert Henderson for actuarial graduation, this 
    moving average provides exceptional smoothness while maintaining responsiveness to price changes.
  </p>
  <p>
    Unlike simple or exponential moving averages, HWMA uses a polynomial weighting scheme that 
    minimizes the sum of squared third differences, resulting in a very smooth curve that still 
    captures important price movements. The symmetric nature of the weights means it doesn't 
    introduce phase shift like many other smoothing techniques, making it particularly useful 
    for trend identification and cycle analysis.
  </p>

  <h2 id="interpretation">Interpretation</h2>
  <h3>Trend Identification</h3>
  <ul>
    <li><strong>Rising HWMA:</strong> Indicates upward trend with smooth confirmation</li>
    <li><strong>Falling HWMA:</strong> Indicates downward trend with reduced noise</li>
    <li><strong>HWMA slope:</strong> Steeper slopes indicate stronger trends</li>
    <li><strong>Price vs HWMA:</strong> Price above HWMA suggests bullish bias</li>
  </ul>

  <h3>Signal Generation</h3>
  <ul>
    <li><strong>Crossovers:</strong> Price crossing HWMA provides trend signals</li>
    <li><strong>HWMA turns:</strong> Changes in HWMA direction signal potential reversals</li>
    <li><strong>Support/Resistance:</strong> HWMA acts as dynamic support in uptrends</li>
    <li><strong>Smoothing quality:</strong> Less whipsaws than simple moving averages</li>
  </ul>

  <h3>Key Advantages</h3>
  <ul>
    <li><strong>Exceptional smoothness:</strong> Reduces market noise effectively</li>
    <li><strong>No phase lag:</strong> Symmetric weights preserve timing</li>
    <li><strong>Reduced overshoot:</strong> Polynomial design minimizes false signals</li>
    <li><strong>Trend clarity:</strong> Clear identification of underlying trend</li>
  </ul>

  <h2 id="calculation">Calculation</h2>
  <p>The Henderson Weighted Moving Average calculation involves:</p>
  <ol>
    <li><strong>Determine weights:</strong> Calculate Henderson weights for given period</li>
    <li><strong>Weight formula:</strong> Based on minimizing sum of squared third differences</li>
    <li><strong>For 5-term HWMA:</strong> Weights = [−0.07, 0.29, 0.56, 0.29, −0.07]</li>
    <li><strong>For 7-term HWMA:</strong> Weights = [−0.06, 0.09, 0.26, 0.34, 0.26, 0.09, −0.06]</li>
    <li><strong>Apply weights:</strong> <code>HWMA = Σ(weight[i] × price[i])</code></li>
    <li><strong>Normalize:</strong> Ensure weights sum to 1.0</li>
  </ol>
  <p>
    The weights are derived from Henderson's graduation formula, which finds the smoothest 
    curve (minimum curvature) that passes through the data points. Note that some weights 
    can be negative, which helps achieve the exceptional smoothness characteristic of HWMA.
  </p>

  <h2 id="parameters">Parameters</h2>
  <ul>
    <li>
      <strong>Period (default: 14):</strong> The lookback period for the moving average. Must be 
      an odd number of at least 5. Common values include 5, 7, 9, 13, and 21. Longer periods 
      provide more smoothing but increase lag. The period determines the number of Henderson 
      weights calculated and applied to the price data.
    </li>
  </ul>

  <h2 id="returns">Returns & Output</h2>
  <p>The indicator returns an array representing the Henderson Weighted Moving Average values:</p>
  <ul>
    <li><strong>Type:</strong> Array of floating-point numbers</li>
    <li><strong>Length:</strong> Same as input array</li>
    <li><strong>Initial values:</strong> First (period-1)/2 values will be null/undefined</li>
    <li><strong>Range:</strong> Smoothed values typically within price range</li>
    <li><strong>Characteristics:</strong> Very smooth with minimal lag</li>
  </ul>

  <h2 id="usage">Example Usage</h2>
  <h3>Rust Implementation</h3>
  <pre><code class="language-rust"> // Rust implementation example will be added here
</code></pre>

  <h3>Python Integration</h3> <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h2 id="use-cases"> Common Use Cases</h2> <h3>1. Trend Following System</h3> <p>Using HWMA for smooth trend identification:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h3>2. Support/Resistance Trading</h3> <p>Using HWMA as dynamic support/resistance:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h3>3. Cycle Analysis with HWMA</h3> <p>Combining HWMA with cycle indicators:</p>
  <pre><code class="language-python"> # Python implementation example will be added here
</code></pre>

  <h2 id="edge-cases"> Edge Cases & Errors</h2>
  <h3>Common Issues</h3>
  <ul>
    <li><strong>Minimum period:</strong> Period must be at least 5 and odd</li>
    <li><strong>Edge effects:</strong> First few values affected by insufficient data</li>
    <li><strong>Negative weights:</strong> Can produce values outside price range temporarily</li>
    <li><strong>Lag in trends:</strong> Despite low lag, still behind in strong trends</li>
  </ul>

  <h3>Best Practices</h3>
  <ul>
    <li>Use odd periods only (5, 7, 9, 13, 21, etc.)</li>
    <li>Combine with momentum indicators for confirmation</li>
    <li>Monitor HWMA slope for trend strength</li>
    <li>Use multiple timeframes for better perspective</li>
    <li>Be aware of the smoothing delay in volatile markets</li>
    <li>Test different periods for your specific market</li>
  </ul>

  <h2 id="references">References</h2>
  <ul>
    <li>Henderson, R. (1916). "Note on graduation by adjusted average". <em>Transactions of the Actuarial Society of America</em></li>
    <li>Kenny, P.B. & Durbin, J. (1982). "Local trend estimation and seasonal adjustment of economic and social time series"</li>
    <li>Technical analysis applications of actuarial smoothing techniques</li>
    <li>Comparison with other weighted moving averages (WMA, EMA, ALMA)</li>
  </ul>
</IndicatorLayout>
