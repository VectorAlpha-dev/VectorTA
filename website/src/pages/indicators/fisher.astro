---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'fisher';
const indicatorName = 'Fisher Transform';
const description = `The Fisher Transform, developed by John Ehlers, converts price data into a Gaussian normal distribution, making turning points clearer and more pronounced. By transforming prices to have properties similar to a sine wave, the Fisher Transform creates sharp, timely signals that often lead price action, making it excellent for identifying reversals.`;
const parameters = [
  {
    "name": "period",
    "type": "number",
    "default": 10,
    "min": 5,
    "max": 30,
    "description": "Lookback period for price normalization"
  },
  {
    "name": "smoothing",
    "type": "number",
    "default": 1,
    "min": 1,
    "max": 5,
    "description": "Smoothing period for the transform"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2>Overview</h2>
  <p>
    The Fisher Transform represents one of John Ehlers' most innovative contributions to technical analysis, applying 
    advanced mathematical concepts to create clearer trading signals. By transforming price data to follow a Gaussian 
    normal distribution, the Fisher Transform amplifies price movements near the extremes, making turning points much 
    more pronounced than in the original price data. This mathematical transformation creates an oscillator that swings 
    between extremes with sharp, clear reversals that often precede actual price turns.
  </p>
  <p>
    What makes the Fisher Transform particularly powerful is its ability to normalize price movements regardless of the 
    underlying market's characteristics. Whether dealing with trending or ranging markets, volatile or quiet conditions, 
    the transform adjusts to create consistent, comparable signals. The indicator produces near-instantaneous responses 
    to price changes, with its sharp peaks and valleys providing clear entry and exit signals that are often several 
    bars ahead of the price reversal itself.
  </p>

  <h2>How It Works</h2>
  <p>The Fisher Transform applies a mathematical transformation to normalized prices:</p>
  <ol>
    <li><strong>Normalize Price:</strong> Scale price to -1 to +1 range over period</li>
    <li><strong>Apply Transform:</strong> Use inverse hyperbolic tangent function</li>
    <li><strong>Create Oscillator:</strong> Result swings between extremes</li>
    <li><strong>Add Signal Line:</strong> Previous Fisher value for crossovers</li>
    <li><strong>Identify Reversals:</strong> Sharp turns indicate price reversals</li>
  </ol>
  
  <div class="not-prose bg-gray-100 dark:bg-gray-800 p-4 rounded-lg my-4 border border-gray-200 dark:border-gray-700">
    <p class="font-mono text-sm mb-0 text-gray-800 dark:text-gray-200">
      Step 1: Find price range over period<br/>
      MaxH = Highest High over period<br/>
      MinL = Lowest Low over period<br/>
      <br/>
      Step 2: Normalize price to [-1, +1]<br/>
      Raw Value = (2 × ((Price - MinL) / (MaxH - MinL))) - 1<br/>
      Value = Constrain to [-0.999, +0.999]<br/>
      <br/>
      Step 3: Apply Fisher Transform<br/>
      Fisher = 0.5 × ln((1 + Value) / (1 - Value))<br/>
      <br/>
      Step 4: Smooth if desired<br/>
      Fisher = EMA(Fisher, smoothing)<br/>
      <br/>
      Signal Line = Fisher[1] (previous value)<br/>
      <br/>
      Key Levels:<br/>
      Extreme High: Above +2.0 to +3.0<br/>
      Extreme Low: Below -2.0 to -3.0<br/>
      <br/>
      Signals:<br/>
      Fisher peak + cross below signal = Sell<br/>
      Fisher trough + cross above signal = Buy
    </p>
  </div>

  <h2>Key Features</h2>
  <ul>
    <li><strong>Gaussian Distribution:</strong> Transforms prices to normal distribution</li>
    <li><strong>Sharp Reversals:</strong> Clear peaks and troughs at turning points</li>
    <li><strong>Leading Indicator:</strong> Often signals before price reverses</li>
    <li><strong>Normalized Output:</strong> Consistent signals across different markets</li>
  </ul>

  <h2>Interpretation & Trading Signals</h2>
  
  <h3>Fisher Transform Analysis</h3>
  <div class="not-prose bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg my-4 border border-blue-200 dark:border-blue-800">
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Signal Identification:</h4>
    <ul class="list-disc list-inside mb-4 text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Extreme Readings:</strong> Above +2.5 or below -2.5 signal reversals</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Sharp Peaks/Troughs:</strong> V-shaped turns indicate strong reversals</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Signal Crossovers:</strong> Fisher crossing signal line confirms direction</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Divergences:</strong> Fisher/price divergences warn of reversals</li>
    </ul>
    
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100">Trading Signals:</h4>
    <ul class="list-disc list-inside text-gray-700 dark:text-gray-300">
      <li><strong class="text-gray-900 dark:text-gray-100">Buy Signal:</strong> Fisher turns up from below -2 and crosses signal</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Sell Signal:</strong> Fisher turns down from above +2 and crosses signal</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Strong Trend:</strong> Fisher stays above/below zero for extended periods</li>
      <li><strong class="text-gray-900 dark:text-gray-100">Ranging Market:</strong> Fisher oscillates around zero frequently</li>
    </ul>
  </div>

  <h3>Trading Strategies</h3>
  <ul>
    <li><strong>Reversal Trading:</strong>
      <ul>
        <li>Wait for Fisher to reach extreme levels (±2.5)</li>
        <li>Look for sharp reversal in Fisher direction</li>
        <li>Enter when Fisher crosses signal line</li>
        <li>Place stop beyond recent price extreme</li>
      </ul>
    </li>
    <li><strong>Divergence Strategy:</strong>
      <ul>
        <li>Identify price making new high/low</li>
        <li>Check if Fisher makes lower high/higher low</li>
        <li>Enter on Fisher signal line crossover</li>
        <li>Target previous swing high/low</li>
      </ul>
    </li>
    <li><strong>Trend Continuation:</strong>
      <ul>
        <li>Buy pullbacks when Fisher remains above zero</li>
        <li>Sell rallies when Fisher remains below zero</li>
        <li>Use Fisher turning up/down as entry trigger</li>
        <li>Exit on opposite extreme reading</li>
      </ul>
    </li>
    <li><strong>Multiple Timeframe:</strong> Align Fisher signals across timeframes</li>
  </ul>

  <h3>Advanced Techniques</h3>
  <ul>
    <li><strong>Fisher Bands:</strong> Add standard deviation bands for extremes</li>
    <li><strong>Smoothed Fisher:</strong> Apply additional smoothing for trends</li>
    <li><strong>Fisher RSI:</strong> Apply transform to RSI for enhanced signals</li>
    <li><strong>Composite Fisher:</strong> Combine multiple period Fisher transforms</li>
  </ul>

  <h2>Practical Application</h2>
  
  <h3>Strengths</h3>
  <ul>
    <li>Creates sharp, clear reversal signals</li>
    <li>Often leads price at turning points</li>
    <li>Works well in ranging markets</li>
    <li>Normalized output across markets</li>
    <li>Excellent for timing entries and exits</li>
  </ul>

  <h3>Limitations</h3>
  <ul>
    <li>Can give premature signals in strong trends</li>
    <li>Extreme readings don't guarantee reversals</li>
    <li>Requires practice to interpret correctly</li>
    <li>May whipsaw in choppy conditions</li>
    <li>Less effective during news events</li>
  </ul>

  <h2>Combination with Other Indicators</h2>
  <p>Fisher Transform works exceptionally well with:</p>
  <ul>
    <li><strong>RSI:</strong> Fisher for timing, RSI for confirmation</li>
    <li><strong>MACD:</strong> Fisher for reversals, MACD for trend</li>
    <li><strong>Support/Resistance:</strong> Fisher signals at key levels</li>
    <li><strong>Ehlers Indicators:</strong> Combine with other Ehlers tools</li>
    <li><strong>Volume:</strong> Confirm Fisher reversals with volume</li>
  </ul>

  <h2>Example Usage</h2>
  <p>Code examples will be available once the Rust implementation is complete.</p>

  <h2>Mathematical Background</h2>
  <p>
    The mathematical brilliance of the Fisher Transform lies in its use of the inverse hyperbolic tangent function 
    (atanh) to convert bounded price data into an unbounded Gaussian distribution. This transformation has the effect 
    of expanding price movements near the boundaries (market extremes) while compressing movements near the center 
    (average prices). The result is an indicator that dramatically amplifies turning points, making them impossible 
    to miss.
  </p>
  <p>
    The formula 0.5 × ln((1+x)/(1-x)) is the inverse of the hyperbolic tangent function, which maps values from the 
    interval (-1, 1) to the entire real line (-∞, +∞). This creates a distribution with properties similar to a normal 
    distribution, where extreme values become increasingly rare and significant. By applying this transform to normalized 
    price data, Ehlers created an indicator that naturally identifies statistically significant price movements and 
    provides earlier warnings of impending reversals than traditional oscillators.
  </p>
</IndicatorLayout>