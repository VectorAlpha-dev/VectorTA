---
import IndicatorLayout from '../../layouts/IndicatorLayout.astro';

const indicatorId = 'di';
const indicatorName = 'Directional Indicator (+DI/-DI)';
const description = `The Directional Indicators (+DI and -DI) are components of Welles Wilder's Directional Movement System that measure the strength of upward and downward price movements. These indicators help traders identify which direction has dominant momentum, providing clear signals for trend direction and potential entry points when crossovers occur.`;
const parameters = [
  {
    "name": "period",
    "type": "number",
    "default": 14,
    "min": 10,
    "max": 30,
    "description": "Smoothing period for directional movement calculation"
  }
];
---

<IndicatorLayout
  indicatorId={indicatorId}
  indicatorName={indicatorName}
  description={description}
  parameters={parameters}
>
  <h2>Overview</h2>
  <p>
    The Directional Indicators, consisting of Plus Directional Indicator (+DI) and Minus Directional Indicator (-DI), 
    are fundamental components of Welles Wilder's revolutionary Directional Movement System introduced in 1978. These 
    indicators go beyond simple trend identification by quantifying the strength of bullish versus bearish momentum, 
    providing traders with a clear view of which force currently dominates the market.
  </p>
  <p>
    What makes the DI indicators unique is their focus on directional movement rather than just price change. By 
    comparing the current high/low to the previous high/low, they capture the market's ability to make new extremes 
    in either direction. When +DI is above -DI, buyers are in control; when -DI dominates, sellers rule. The 
    crossovers between these lines often signal trend changes before they become apparent in price action alone.
  </p>

  <h2>How It Works</h2>
  <p>The DI calculation involves measuring directional movements:</p>
  <ol>
    <li><strong>Calculate +DM:</strong> Upward directional movement (current high - previous high)</li>
    <li><strong>Calculate -DM:</strong> Downward directional movement (previous low - current low)</li>
    <li><strong>Determine Dominant Direction:</strong> Use larger of +DM or -DM (set other to 0)</li>
    <li><strong>Smooth with ATR:</strong> Apply Wilder's smoothing and normalize by ATR</li>
    <li><strong>Create Indicators:</strong> +DI and -DI oscillate between 0 and 100</li>
  </ol>
  
  <div class="not-prose bg-gray-100 dark:bg-gray-800 p-4 rounded-lg my-4 border border-gray-200 dark:border-gray-700">
    <p class="font-mono text-sm mb-0 text-gray-800 dark:text-gray-200"> +DM = Current High - Previous High (if positive, else 0)<br/>
      -DM = Previous Low - Current Low (if positive, else 0)<br/>
      <br/>
      If +DM &gt; -DM and +DM &gt; 0: Use +DM, set -DM = 0<br/>
      If -DM &gt; +DM and -DM &gt; 0: Use -DM, set +DM = 0<br/>
      If +DM = -DM: Both = 0<br/>
      <br/>
      Smoothed +DM = Previous Smoothed +DM - (Previous Smoothed +DM / Period) + Current +DM<br/>
      Smoothed -DM = Previous Smoothed -DM - (Previous Smoothed -DM / Period) + Current -DM<br/>
      <br/>
      +DI = (Smoothed +DM / ATR) × 100<br/>
      -DI = (Smoothed -DM / ATR) × 100
    </p>
  </div>

  <h2>Key Features</h2>
  <ul>
    <li><strong>Directional Strength:</strong> Measures bullish vs bearish momentum</li>
    <li><strong>Normalized Values:</strong> 0-100 scale for easy comparison</li>
    <li><strong>Trend Identification:</strong> Clear view of dominant market direction</li>
    <li><strong>Early Signals:</strong> Crossovers often precede price trend changes</li>
  </ul>

  <h2>Interpretation & Trading Signals</h2>
  
  <h3>DI Analysis</h3>
  <div class="not-prose bg-blue-50 dark:bg-blue-950/30 p-4 rounded-lg my-4 border border-blue-200 dark:border-blue-800">
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100"> Directional Dominance:</h4> <ul class="list-disc list-inside mb-4 text-gray-700 dark:text-gray-300"> <li><strong class="text-gray-900 dark:text-gray-100"> +DI &gt; -DI:</strong> Bullish momentum dominant</li>
      <li><strong class="text-gray-900 dark:text-gray-100">-DI &gt; +DI:</strong> Bearish momentum dominant</li>
      <li><strong class="text-gray-900 dark:text-gray-100"> Wide Spread:</strong> Strong trending conditions</li>
      <li><strong class="text-gray-900 dark:text-gray-100"> Narrow Spread:</strong> Weak trend or consolidation</li>
    </ul>
    
    <h4 class="font-semibold mb-2 text-lg text-blue-900 dark:text-blue-100"> Trading Signals:</h4> <ul class="list-disc list-inside text-gray-700 dark:text-gray-300"> <li><strong class="text-gray-900 dark:text-gray-100"> +DI Crosses Above -DI:</strong> Bullish signal, uptrend starting</li>
      <li><strong class="text-gray-900 dark:text-gray-100">-DI Crosses Above +DI:</strong> Bearish signal, downtrend starting</li>
      <li><strong class="text-gray-900 dark:text-gray-100"> Extreme Readings (&gt;40):</strong> Strong directional movement</li>
      <li><strong class="text-gray-900 dark:text-gray-100"> Both DIs Below 20:</strong> Lack of directional movement</li>
    </ul>
  </div>

  <h3>Trading Strategies</h3>
  <ul>
    <li><strong>Crossover System:</strong>
      <ul>
        <li>Buy when +DI crosses above -DI</li>
        <li>Sell when -DI crosses above +DI</li>
        <li>Confirm with ADX above 25 for trend strength</li>
      </ul>
    </li>
    <li><strong>Trend Confirmation:</strong>
      <ul>
        <li>Only take long positions when +DI &gt; -DI</li>
        <li>Only take short positions when -DI &gt; +DI</li>
        <li>Exit when DIs converge (trend weakening)</li>
      </ul>
    </li>
    <li><strong>Extreme DI Strategy:</strong>
      <ul>
        <li>Look for +DI or -DI above 40</li>
        <li>Trade in direction of dominant DI</li>
        <li>Exit when extreme DI falls below 30</li>
      </ul>
    </li>
    <li><strong>DI Divergence:</strong> Watch for price/DI divergences at trend extremes</li>
  </ul>

  <h3>Advanced Techniques</h3>
  <ul>
    <li><strong>DI Spread Analysis:</strong> Use (+DI minus -DI) as momentum oscillator</li>
    <li><strong>Multiple Timeframes:</strong> Align DI signals across timeframes</li>
    <li><strong>Volatility Filter:</strong> Combine with ATR for position sizing</li>
    <li><strong>Pattern Recognition:</strong> DI patterns often precede price patterns</li>
  </ul>

  <h2>Practical Application</h2>
  
  <h3>Strengths</h3>
  <ul>
    <li>Clear directional signals</li>
    <li>Works well in trending markets</li>
    <li>Early trend change detection</li>
    <li>Complements ADX perfectly</li>
    <li>Objective and quantifiable</li>
  </ul>

  <h3>Limitations</h3>
  <ul>
    <li>Whipsaws in ranging markets</li>
    <li>Lagging indicator by nature</li>
    <li>Requires confirmation from other tools</li>
    <li>Less effective in choppy conditions</li>
    <li>Can remain extended in strong trends</li>
  </ul>

  <h2>Combination with Other Indicators</h2>
  <p>The DI indicators work best with:</p>
  <ul>
    <li><strong>ADX:</strong> Use together for complete directional system</li>
    <li><strong>Moving Averages:</strong> Confirm DI signals with MA direction</li>
    <li><strong>RSI/Stochastic:</strong> Time entries at oversold/overbought with DI direction</li>
    <li><strong>Support/Resistance:</strong> Trade DI signals at key levels</li>
    <li><strong>Volume:</strong> Confirm DI crossovers with volume increase</li>
  </ul>

  <h2>Example Usage</h2>
  <p>Code examples will be available once the Rust implementation is complete.</p>

  <h2>Mathematical Background</h2>
  <p>
    The mathematical innovation of the Directional Indicators lies in their ability to separate upward and downward 
    price movements into distinct measurements. By comparing consecutive highs and lows rather than just closing 
    prices, Wilder captured the market's directional intent. The normalization by ATR ensures that the indicators 
    remain comparable across different volatility regimes and markets.
  </p>
  <p>
    The smoothing technique Wilder developed (essentially a form of exponential smoothing with a different calculation 
    method) provides the perfect balance between responsiveness and stability. The 14-period default creates indicators 
    that react quickly enough to catch trend changes but smoothly enough to avoid excessive whipsaws. This mathematical 
    framework has stood the test of time, remaining one of the most reliable trend identification systems in technical analysis.
  </p>

</IndicatorLayout>
