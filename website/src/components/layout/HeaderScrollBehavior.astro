---
// This component adds scroll-based behavior to the header
---

<script>
  let lastScroll = 0;
  let scrollTimeout: ReturnType<typeof setTimeout>;
  const header = document.querySelector('header');
  
  if (header) {
    // Add initial class for styling
    header.classList.add('header-transition');
    
    window.addEventListener('scroll', () => {
      const currentScroll = window.pageYOffset;
      
      // Clear the timeout on each scroll event
      clearTimeout(scrollTimeout);
      
      // Add/remove classes based on scroll direction and position
      if (currentScroll <= 0) {
        // At the top
        header.classList.remove('header-scrolled', 'header-hidden');
        header.classList.add('header-top');
      } else if (currentScroll > lastScroll && currentScroll > 80) {
        // Scrolling down & past 80px
        header.classList.remove('header-top');
        header.classList.add('header-scrolled', 'header-hidden');
      } else if (currentScroll < lastScroll) {
        // Scrolling up
        header.classList.remove('header-hidden', 'header-top');
        header.classList.add('header-scrolled');
      }
      
      // Update last scroll position
      lastScroll = currentScroll;
      
      // Set a timeout to show header after scrolling stops
      scrollTimeout = setTimeout(() => {
        if (currentScroll > 0) {
          header.classList.remove('header-hidden');
        }
      }, 300);
    });
  }
</script>

<style>
  :global(.header-transition) {
    transition: transform 0.3s ease, backdrop-filter 0.3s ease, background-color 0.3s ease;
  }
  
  :global(.header-top) {
    background-color: transparent;
    backdrop-filter: none;
  }
  
  :global(.header-scrolled) {
    backdrop-filter: blur(10px);
    background-color: hsl(var(--background) / 0.8);
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.1);
  }
  
  :global(.dark .header-scrolled) {
    background-color: hsl(var(--background) / 0.9);
    box-shadow: 0 1px 3px 0 rgba(0, 0, 0, 0.3);
  }
  
  :global(.header-hidden) {
    transform: translateY(-100%);
  }
</style>
